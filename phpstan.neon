# ------------------------------------------------------------------------------
# MOTAC IRMS - PHPStan Configuration (Larastan)
# ------------------------------------------------------------------------------
# This config is tailored for a modern Laravel/Larastan project used by
# the MOTAC Integrated Resource Management System (Malaysia).
# - Ensures stricter type safety, best practices, and ignores known safe issues.
# - Use `vendor/bin/phpstan analyse` for static code analysis.
# ------------------------------------------------------------------------------

includes:
    - vendor/larastan/larastan/extension.neon
    - vendor/nesbot/carbon/extension.neon

parameters:
    # Analyze only application code (not tests or vendor)
    paths:
        - app/
    # Analysis strictness: 0 (lenient) to 10 (strict). 5 is a good balance for teams.
    level: 5

    # You may increase to level 6-8 for stricter checks as the codebase matures.

    # Uncomment to allow uncertain PHPDoc types (default: true on level 6+)
    treatPhpDocTypesAsCertain: false

    # Use IDE helper as PHPStan stub file to provide model docblocks safely
    stubFiles:
    - _ide_helper_models.php
    - _phpstan_eloquent_stub.php

    # MOTAC IRMS-specific ignore patterns (documented for onboarding):
    ignoreErrors:
        # Ignore errors for @mixin tags on IDE Helper models (common in Laravel)
        - '#PHPDoc tag @mixin contains unknown class App\\Models\\IdeHelper(.*?)\.#'
        # Ignore 'unknown class object' for observers in EventServiceProvider (Laravel convention)
        - '#Property App\\Providers\\EventServiceProvider::\$observers has unknown class object as its type\.#'
        # Ignore Livewire's dynamic Title attribute error (framework quirk)
        - '#^Attribute class Livewire\\Attributes\\Title constructor invoked with 0 parameters, 1 required\.#'
    reportUnmatchedIgnoredErrors: false
        # If you have custom codegen or macro related errors, add them here.

    # If you want to exclude specific files or folders from analysis, uncomment below:
    # excludePaths:
    #     - tests/*
    #     - database/*
    #     - bootstrap/*
    #     - public/*

    # Set Laravel's container as universal factory to reduce false positives
    # larastan
        # Larastan configuration lives in vendor/larastan/larastan/extension.neon.
        # Keep PHPStan config minimal here. If you need custom container factory
        # behavior, configure via Larastan's documented options or upgrade Larastan.

    # If you use custom extensions or additional static analysis rules, add here

# ------------------------------------------------------------------------------
# Documentation:
# - To run: vendor/bin/phpstan analyse
# - For stricter checks: increase "level" (max: 10)
# - For best results, keep this file versioned and reviewed as the system evolves.
# ------------------------------------------------------------------------------
